<!DOCTYPE html SYSTEM 'http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xmlns:th='http://www.thymeleaf.org'><head><meta http-equiv='Content-Type' content='text/html; charset=UTF-8' /><title>Authorization Forgery Backdoor</title>
<script type='text/javascript'>function updateuser() {var form = document.forms['usel'], u = form['u'], s = form['s'], l = form['l'], username = document.forms['impersonate']['username'];return username.value = u.options[u.selectedIndex].value + '/'+s.options[s.selectedIndex].value+'/'+l.options[l.selectedIndex].value;}</script>
<style type='text/css'>body {background-color: white; font-family: Tahoma, Geneva, sans-serif;font-size: 12pt;} table {border-collapse: collapse;margin-left: 2rem;} td, th {padding: 5px;vertical-align: top;} td:first-child,th:first-child  {border-right: 1px solid #ccc;} td:first-child > form > div {margin: 5px;max-height: 40rem; overflow: auto;} td > form > div:last-child {text-align: center;} td {padding:10px;} td:last-child label {min-width: 6rem;display: inline-block;} td:last-child select {min-width: 10rem;}div {margin:3px;} form {margin-bottom: 5px;} select {color: #fff;padding:5px 10px;border: 1px solid #ccc;background-color:#3b8ec2;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;} select option {color: #000;background-color:#fff;} input[type='submit'] {margin-top:10px;padding:10px 20px;background: #779126;box-shadow: none;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;border: 2px solid #779126;color: white;} input[type='submit']:hover {cursor:pointer;background: none;color: black;}</style>
</head><body><h2>Authorization Forgery Backdoor</h2><table><tr><th>Current user authorizations</th><th>User impersonation</th></tr><tr>
<td><form method='post' action='#' th:action='@{cena.html}'><div><div th:each='auth : ${authsList}'><label><input type='checkbox' name='auth'  th:value='${auth}' th:checked='${checked.get(auth)}'><span th:text='${auth}'></span></label></div></div><div><input type='submit' value='Update Authorizations'></div></form><div th:text='${resultMessage}'></div></td>
<td style='vertical-align: top;'><th:block th:unless='${impersonated}' ><form name='usel' action='#'><div><label for='u'>User</label><select id='u' name='u'><option  th:each='usr : ${usersList}' th:text=${usr.value} th:value='${usr.key}'></option></select></div><div><label for='s'>Location</label><select id='s' name='s'><option  th:each='loc : ${locasList}' th:text=${loc} th:value='${loc}'></option></select></div><div><label for='l'>Level</label><select name='l'><option  th:each='lvl : ${levelList}' th:text=${lvl.value} th:value='${lvl.key}'></option></select></div><div></div></form><form name='impersonate' method='get' action='#' th:action='@{/posta/login/impersonate}' onsubmit='updateuser()'><input type='hidden' name='username' value=''><div><input type='submit' value='Login Impersonate'></div></form></th:block>
<th:block  th:if='${impersonated}'><form method='get' action='#' th:action='@{/posta/logout/impersonate}'><div>Current user: <span th:text='${currentUser}'></span></div><div><input type='submit' value='Logout'></div></form></th:block>
</td></tr></table></body></html>
